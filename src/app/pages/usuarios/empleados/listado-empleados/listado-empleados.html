<section class="empleados-page">
    <h1 class="gest-usuarios" routerLink="/gestion_usuarios">Gestión de usuarios</h1><h1>></h1> <h1>Listado de empleados</h1>

  @if (loading) {
    <div class="status">Cargando empleados...</div>
  }
  @if (!loading && errorMsg) {
    <div class="status error">{{ errorMsg }}</div>
  }

  <div class="actions">
    <button routerLink="/form_empleado" class="btn-filter">Crear nuevo empleado</button>

    <button class="btn-filter" (click)="filtrarEmpleados(true)">Mostrar empleados activos</button>
    <button class="btn-filter" (click)="filtrarEmpleados(false)">Mostrar empleados inactivos</button>
  </div>

  <!-- Tabla de empleados -->
  @if (!loading && !errorMsg && empleados.length > 0) {
    <table class="tabla-empleados">
      <thead>
        <tr>
          <th class="sortable" (click)="onSort('nombre')">Nombre
            @if (sortField === 'nombre') {
              <span class="sort-indicator">
                {{ sortDirection === 'asc' ? '▲' : '▼' }}
              </span>
            }
          </th>
          <th class="sortable" (click)="onSort('role')">Rol
            @if (sortField === 'role') {
              <span class="sort-indicator">
                {{ sortDirection === 'asc' ? '▲' : '▼' }}
              </span>
            }
          </th>
          <th class="sortable" (click)="onSort('email')">Email
            @if (sortField === 'email') {
              <span class="sort-indicator">
                {{ sortDirection === 'asc' ? '▲' : '▼' }}
              </span>
            }
          </th>
          <th class="sortable" (click)="onSort('dni')">DNI
            @if (sortField === 'dni') {
              <span class="sort-indicator">
                {{ sortDirection === 'asc' ? '▲' : '▼' }}
              </span>
            }
          </th>
          <th class="sortable" (click)="onSort('phoneNumber')">Teléfono
            @if (sortField === 'phoneNumber') {
              <span class="sort-indicator">
                {{ sortDirection === 'asc' ? '▲' : '▼' }}
              </span>
            }
          </th>
          <th class="sortable" (click)="onSort('activo')">Estado
            @if (sortField === 'activo') {
              <span class="sort-indicator">
                {{ sortDirection === 'asc' ? '▲' : '▼' }}
              </span>
            }
          </th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        @for (e of empleados; track e.id) { <tr [ngClass]="{'activo': e.activo, 'inactivo': !e.activo}">
            <td>{{ e.nombre }} {{ e.apellido }}</td>
            <td>{{ e.role }}</td>
            <td>{{ e.email }}</td>
            <td>{{ e.dni }}</td>
            <td>{{ e.phoneNumber }}</td>
            <td>
              <div [ngClass]="{'activo': e.activo, 'inactivo': !e.activo}" class="estado">
                {{ e.activo ? 'Activo' : 'Inactivo' }}
              </div>
            </td>
            <td>
              <button class="btn-link" [routerLink]="['/form_empleado', e.id]">Ver detalles</button>
            </td>
          </tr>
        }
      </tbody>
    </table>
  } @else if (!loading && !errorMsg) {
    <div class="empty">
      No hay empleados registrados todavía.
    </div>
  }
</section>