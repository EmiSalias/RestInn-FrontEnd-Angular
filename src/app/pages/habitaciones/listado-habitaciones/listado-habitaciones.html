<section class="habitaciones-list">
    <h3 class="section-title">Habitaciones</h3>

    <!-- FILTROS -->
    <form class="filtros" (ngSubmit)="filtrarHabitaciones()">
        <div class="filtros-row">
            <div class="filtro">
                <label>Estado: </label>
                <select [(ngModel)]="filtros.estado" name="estado">
                    <option hidden value="">Seleccionar</option>
                    <option value="DISPONIBLE">Disponible</option>
                    <option value="OCUPADA">Ocupada</option>
                    <option value="MANTENIMIENTO">Mantenimiento</option>
                    <option value="LIMPIEZA">Limpieza</option>
                </select>
            </div>

            <!-- Capacidad -->
            <div class="filtro">
                <label>Capacidad: </label>
                <input type="number" [(ngModel)]="filtros.capacidadMin" name="capacidadMin" placeholder="mín">
                <span>—</span>
                <input type="number" [(ngModel)]="filtros.capacidadMax" name="capacidadMax" placeholder="máx">
            </div>

            <!-- Precio -->
            <div class="filtro">
                <label>Precio: </label>
                <input type="number" [(ngModel)]="filtros.precioMin" name="precioMin" placeholder="mín">
                <span>—</span>
                <input type="number" [(ngModel)]="filtros.precioMax" name="precioMax" placeholder="máx">
            </div>

            <div class="filtro">
                <label>Tipo: </label>
                <input type="number" [(ngModel)]="filtros.cantCamas" name="cantCamas" placeholder="Camas">
            </div>

            <div class="filtro">
                <label>Tipo: </label>
                <select [(ngModel)]="filtros.tipo" name="tipo">
                    <option hidden value="">Seleccionar</option>
                    <option value="SIMPLE">Simple</option>
                    <option value="INDIVIDUAL">Individual</option>
                    <option value="DOBLE">Doble</option>
                    <option value="TRIPLE">Triple</option>
                    <option value="CUADRUPLE">Cuadriple</option>
                    <option value="SUITE">Suite</option>
                    <option value="DELUXE">Deluxe</option>
                    <option value="ESTUDIO">Estudio</option>
                </select>
            </div>

            <button type="submit">Filtrar</button>
            <button type="button" (click)="limpiarFiltros()">Limpiar</button>

            <!-- ORDENAMIENTO -->
            <div class="filtro">
                <label for="orden">Ordenar por:</label>
                <select id="orden" [(ngModel)]="orden" (change)="ordenarHabitaciones()" required>
                    <option hidden value="">Seleccionar</option>
                    <option value="Numero asc">Número ↑</option>
                    <option value="Numero desc">Número ↓</option>
                    <option value="Precio asc">Precio ↑</option>
                    <option value="Precio desc">Precio ↓</option>
                    <option value="Capacidad asc">Capacidad ↑</option>
                    <option value="Capacidad desc">Capacidad ↓</option>
                </select>
            </div>
        </div>

    </form>


    <!-- ESTADOS -->
    @if (loading) {
    <p class="loading">Cargando habitaciones...</p>
    } @else if (errorMsg) {
    <p class="error">{{ errorMsg }}</p>
    } @else {
    <div class="habitaciones-grid">
        @for (hab of habitacionesFiltradas; track hab.id) {
        <div class="habitacion-card">
            <div class="habitacion-card__image-wrapper">
                @if (getMainImageDataUrl(hab)) {
                <img [src]="getMainImageDataUrl(hab)" [alt]="'Habitación ' + hab.numero"
                    class="habitacion-card__image" />
                } @else {
                <div class="habitacion-card__image habitacion-card__image--placeholder">
                    <p>No posee imágenes</p>
                </div>
                }
                <span class="habitacion-card__badge">{{ hab.estado }}</span>
            </div>

            <div class="habitacion-card__body">
                <div class="habitacion-card__header">
                    <div class="habitacion-card__title">Hab. {{ hab.numero }}</div>
                    <div class="habitacion-card__sub">Piso {{ hab.piso }} · {{ hab.tipo }}</div>
                </div>

                <div class="habitacion-card__details">
                    <div class="detail-row">
                        <span class="label">Capacidad: </span>
                        <span class="value">{{ hab.capacidad }} huésped(es)</span>
                    </div>
                    <div class="detail-row">
                        <span class="label">Camas: </span>
                        <span class="value">{{ hab.cantCamas }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="label">Precio/noche: </span>
                        <span class="value price">${{ hab.precioNoche }}</span>
                    </div>
                    @if (hab.comentario) {
                    <div class="detail-row">
                        <span class="label">Nota: </span>
                        <span class="value">{{ hab.comentario }}</span>
                    </div>
                    }
                </div>
            </div>

            <div class="buttons">
                <button (click)="reservarHabitacion()">Reservar</button>
                <button (click)="detailHabitacion(hab)">Detalle</button>
                <button (click)="editHabitacion(hab)">Editar</button>
                <button (click)="deleteHabitacion(hab.id)">Eliminar</button>
            </div>
        </div>
        }
    </div>
    }
</section>